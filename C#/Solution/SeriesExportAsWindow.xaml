<base:BaseWindow x:Class="Solution.SeriesExportAsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Solution"
        xmlns:XSolution="clr-namespace:XSolution" 
        xmlns:system="clr-namespace:System;assembly=mscorlib"
        xmlns:base ="clr-namespace:ThemeManager.Controls;assembly=ThemeManager"
        mc:Ignorable="d"
        Height="700" Width="700" Background="{DynamicResource GlobalBackgroundBrush}" WindowStartupLocation="CenterScreen">
    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/Solution;component/themes/TreeView.xaml"/>
            </ResourceDictionary.MergedDictionaries>
            <Style x:Key="TextBoxStyle1" BasedOn="{StaticResource {x:Type Control}}" TargetType="{x:Type TextBox}">
                <Setter Property="Background" Value="{DynamicResource TextBoxBackground}"/>
                <Setter Property="BorderBrush" Value="#888888"/>
                <Setter Property="Foreground" Value="{DynamicResource ForegroundBrush}"/>
                <Setter Property="BorderThickness" Value="1"/>
                <Setter Property="Padding" Value="2,2,2,1"/>
                <Setter Property="AllowDrop" Value="true"/>
                <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
                <Setter Property="ScrollViewer.PanningMode" Value="VerticalFirst"/>
                <Setter Property="Stylus.IsFlicksEnabled" Value="False"/>
                <Setter Property="SelectionBrush" Value="#0078D7"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type TextBox}">
                            <Border x:Name="Bd" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}"  SnapsToDevicePixels="true">
                                <ScrollViewer x:Name="PART_ContentHost" Background="{TemplateBinding Background}"  Padding="{TemplateBinding Padding}" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsEnabled" Value="false">
                                    <Setter Property="Foreground" Value="{StaticResource TextBoxDisabledForeground}"/>
                                    <Setter Property="Background" TargetName="PART_ContentHost" Value="{StaticResource TextBoxDisabledBackground}"/>
                                    <Setter Property="Background" TargetName="Bd" Value="{StaticResource TextBoxDisabledBackground}"/>
                                    <Setter Property="BorderBrush" TargetName="Bd" Value="{StaticResource TextBoxDisabledBackground}"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </ResourceDictionary>
    </Window.Resources>
    <Grid>
        <TextBlock Text="系列导出" FontSize="15"  HorizontalAlignment="Left"  VerticalAlignment="Top" Margin="10,-20,0,0"/>
        <DockPanel  >
            <UniformGrid Columns="2" DockPanel.Dock="Bottom" HorizontalAlignment="Right" Margin="10">
                <Button Content="取消" Height="20" Width="75" Margin="5,0" Click="Cancel_Click"/>
                <Button Content="导出" Height="20" Width="75" Margin="5,0" Click="OK_Click" />
            </UniformGrid>

            <Border  CornerRadius="3" Margin="10">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="auto"/>
                        <RowDefinition Height="*"/>

                    </Grid.RowDefinitions>
                    <StackPanel>
                        <GroupBox Header="文件设置" BorderThickness="1" BorderBrush="#454545" Padding="5">
                            <StackPanel>
                                <DockPanel Margin="2" >
                                    <Button Width="50" DockPanel.Dock="Right"  Content="..." Click="Button_Click"/>
                                    <TextBlock Text="选择文件位置: " Width="80" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    <TextBox Style="{DynamicResource TextBoxStyle1}" Text="{Binding ExportFullName}"  HorizontalAlignment="Stretch"  Margin="0,0,5,0" />
                                </DockPanel>
                                <DockPanel Margin="2" >
                                    <TextBlock Text="格式: " Width="80" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    <ComboBox SelectedIndex="0" HorizontalContentAlignment="Center" VerticalContentAlignment="Center">
                                        <ComboBoxItem  Content="mp4"/>
                                        <ComboBoxItem  Content="avi"/>
                                        <ComboBoxItem  Content="rar"/>
                                    </ComboBox>
                                </DockPanel>
                                <DockPanel Margin="2" >
                                    <TextBlock Text="模态: " Width="80" HorizontalAlignment="Center" VerticalAlignment="Top"/>
                                    <UniformGrid Columns="3" Visibility="Visible"  Margin="20,0,0,0"   >
                                        <CheckBox x:Name="checkbox51" IsChecked="{Binding Bright,Mode=TwoWay}"  Content="明场"  />
                                        <CheckBox x:Name="checkbox52" IsChecked="{Binding Dark,Mode=TwoWay}" Content="暗场"  />
                                        <CheckBox x:Name="checkbox53" IsChecked="{Binding Rheinberg,Mode=TwoWay}" Content="莱茵" />
                                        <CheckBox x:Name="checkbox54" IsChecked="{Binding Relief,Mode=TwoWay}" Content="差分"  />
                                        <CheckBox x:Name="checkbox55" IsChecked="{Binding Phase,Mode=TwoWay}" Content="相位"  />
                                        <CheckBox x:Name="checkbox56" IsChecked="{Binding Quantitative,Mode=TwoWay}" Content="相差" />
                                    </UniformGrid>
                                </DockPanel>


                            </StackPanel>
                        </GroupBox>
                        <GroupBox Header="导出设置" BorderThickness="1" BorderBrush="#454545" Padding="5" Margin="0,10">
                            <StackPanel>
                                <CheckBox Content="输出叠加图像"/>
                                <CheckBox Content="使用目录"/>
                                <CheckBox Content="使用保存的标注内容"/>
                                <CheckBox Content="保存原始图像"/>
                                <CheckBox Content="导出视图"/>
                                <CheckBox Content="导出兴趣区域（ROI）"/>

                            </StackPanel>
                        </GroupBox>
                        <GroupBox Header="标注" BorderThickness="2" BorderBrush="#454545" Padding="5"  Margin="0,10">
                            <StackPanel>
                                <CheckBox Content="拍照时间"/>
                                <CheckBox Content="相对开始采集时间间隔"/>
                                <CheckBox Content="标尺信息"/>
                                <CheckBox Content="维度信息"/>

                            </StackPanel>
                        </GroupBox>
                    </StackPanel>
                    <UniformGrid Columns="2" Grid.Row="1">
                        <TreeView x:Name="SeriesExportTreeView1">
                            <TreeView.Resources >
                                <DataTemplate x:Key="displayTemplate">
                                    <TextBlock Text="{Binding Path=Name}" ></TextBlock>
                                </DataTemplate>
                                <DataTemplate x:Key="editTemplate">
                                    <TextBox Text="{Binding Path=Name, Mode=OneWay}" Padding="0" Tag="{Binding .}"  LostFocus="TextBox_LostFocus" KeyUp="TextBox_KeyUp"/>
                                </DataTemplate>

                                <Style x:Key="EditableTextBlockStyle"   TargetType="local:EditableTextBlock">
                                    <Style.Triggers>
                                        <Trigger Property="IsEditMode" Value="True">
                                            <Setter Property="ContentTemplate" Value="{StaticResource editTemplate}"/>
                                        </Trigger>
                                        <Trigger Property="IsEditMode" Value="False">
                                            <Setter Property="ContentTemplate" Value="{StaticResource displayTemplate}"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>

                                <HierarchicalDataTemplate  DataType="{x:Type XSolution:SolutionExplorer}"   ItemsSource="{Binding VisualChildren}">
                                    <StackPanel Style="{StaticResource style_treeViewItem_panel}"  >
                                        <TextBlock Text="'"/>
                                        <local:EditableTextBlock   Style="{StaticResource EditableTextBlockStyle}" IsEditMode="{Binding IsEditMode}" Content="{Binding .}"/>
                                        <TextBlock Text="'"/>
                                        <StackPanel.ContextMenu>
                                            <ContextMenu>
                                                <MenuItem Header="添加(_W)">
                                                    <MenuItem Header="新建项目...(_M)" Command="{Binding AddNewProject}"  CommandParameter="{Binding .}"/>
                                                    <MenuItem Header="现有项目...(_N)" />
                                                </MenuItem>
                                                <Separator/>
                                                <MenuItem Header="重命名(_M)"  Command="{x:Static  XSolution:Commands.ReName}"  CommandParameter="{Binding .}"/>
                                                <Separator/>
                                                <MenuItem Header="取消隐藏" Command="{Binding VisibilityUnHidden}"  CommandParameter="{Binding .}"/>
                                                <Separator/>
                                                <MenuItem Header="在文件资源管理器中打开(_x)" Command="{Binding OpenExplorer}"  CommandParameter="{Binding .}"/>
                                                <MenuItem Header="打开日志(_x)" Command="{Binding OpenLog}"  CommandParameter="{Binding .}"/>
                                                <MenuItem Header="属性(_R)"  />
                                            </ContextMenu>
                                        </StackPanel.ContextMenu>
                                    </StackPanel>
                                </HierarchicalDataTemplate>


                                <HierarchicalDataTemplate DataType="{x:Type XSolution:ProjectManager}" ItemsSource="{Binding VisualChildren}" >
                                    <StackPanel Style="{StaticResource style_treeViewItem_panel}" >
                                        <Image Style="{StaticResource style_treeViewItem_icon}" Source="/Solution;component/images/图片2.png" />
                                        <local:EditableTextBlock   Style="{StaticResource EditableTextBlockStyle}" IsEditMode="{Binding IsEditMode}" Content="{Binding .}"/>

                                        <StackPanel.ContextMenu>
                                            <ContextMenu>
                                                <MenuItem Header="新建文件夹(_P)"/>
                                                <MenuItem Header="新建文件(_F)"/>
                                                <MenuItem Header="打开文件夹" />
                                                <Separator/>
                                                <MenuItem Header="移除(_V)" Command="{Binding DeleteCommand}" CommandParameter="{Binding .}"/>
                                                <MenuItem Header="重命名(_M)" Command="{x:Static XSolution:Commands.ReName}" CommandParameter="{Binding .}"/>
                                                <Separator/>
                                                <MenuItem Header="隐藏文件夹(_H)" Command="{Binding VisibilityHidden}" CommandParameter="{Binding .}"/>
                                                <Separator/>

                                                <MenuItem Header="属性(_R)"/>
                                            </ContextMenu>
                                        </StackPanel.ContextMenu>
                                    </StackPanel>
                                </HierarchicalDataTemplate>

                                <HierarchicalDataTemplate DataType="{x:Type XSolution:SeriesProjectManager}" ItemsSource="{Binding VisualChildren}" >
                                    <StackPanel Background="Transparent" Style="{StaticResource style_treeViewItem_panel}"  >
                                        <Image  Style="{StaticResource style_treeViewItem_icon}" Source="/Solution;component/images/图片2.png" />
                                        <local:EditableTextBlock   Style="{StaticResource EditableTextBlockStyle}" IsEditMode="{Binding IsEditMode}" Content="{Binding .}"/>
                                        <TextBlock  FontSize="10" VerticalAlignment="Center" Foreground="White">
                            <Run Text=" -"/>
                            <Run Text="{Binding FileSize}"/>
                                        </TextBlock>
                                        <StackPanel.ContextMenu>
                                            <ContextMenu >
                                                <!--<MenuItem Header="剪切(_T)" Command="{x:Static ApplicationCommands.Cut}" CommandParameter="{Binding .}" />-->
                                                <MenuItem Header="删除(_D)" Command="{Binding DeleteCommand}" CommandParameter="{Binding .}"/>
                                                <MenuItem Header="重命名(_M)" Command="{x:Static XSolution:Commands.ReName}" CommandParameter="{Binding .}"/>
                                                <MenuItem Header="复制(_Y)" Command="{x:Static ApplicationCommands.Copy}" CommandParameter="{Binding .}" />
                                                <Separator/>
                                                <MenuItem Header="导出(_E)" Command="{Binding PoejectExportAs}" CommandParameter="{Binding .}">
                                                </MenuItem>
                                                <MenuItem Header="应用参数(_Y)"  CommandParameter="{Binding .}"/>
                                                <MenuItem Header="文件属性(_R)"  CommandParameter="{Binding .}" />
                                                <MenuItem Header="导入图片设置(_Y)"  CommandParameter="{Binding .}"/>
                                            </ContextMenu>
                                        </StackPanel.ContextMenu>
                                    </StackPanel>
                                </HierarchicalDataTemplate>

                                <HierarchicalDataTemplate DataType="{x:Type XSolution:ProjectFolder}" ItemsSource="{Binding VisualChildren}" >
                                    <StackPanel  Style="{StaticResource style_treeViewItem_panel}" >
                                        <Image  Style="{StaticResource style_treeViewItem_icon}" Source="/Solution;component/images/filer.png" />
                                        <local:EditableTextBlock   Style="{StaticResource EditableTextBlockStyle}" IsEditMode="{Binding IsEditMode}" Content="{Binding .}"/>

                                        <StackPanel.ContextMenu>
                                            <ContextMenu>
                                                <Separator/>
                                                <MenuItem Header="剪切(_T)" Command="{x:Static ApplicationCommands.Cut}" CommandParameter="{Binding .}" />
                                                <MenuItem Header="复制(_Y)" Command="{x:Static ApplicationCommands.Copy}" CommandParameter="{Binding .}" />
                                                <MenuItem Header="删除(_D)" Command="{Binding DeleteCommand}" CommandParameter="{Binding .}"/>
                                                <MenuItem Header="重命名(_M)" Command="{x:Static XSolution:Commands.ReName}" CommandParameter="{Binding .}"/>
                                            </ContextMenu>
                                        </StackPanel.ContextMenu>
                                    </StackPanel>
                                </HierarchicalDataTemplate>

                                <HierarchicalDataTemplate DataType="{x:Type XSolution:ProjectFile}" ItemsSource="{Binding VisualChildren}" >
                                    <StackPanel Background="Transparent" Style="{StaticResource style_treeViewItem_panel}"  >
                                        <Image  Style="{StaticResource style_treeViewItem_icon}" Source="/Solution;component/images/图片3.png" />
                                        <local:EditableTextBlock   Style="{StaticResource EditableTextBlockStyle}" IsEditMode="{Binding IsEditMode}" Content="{Binding .}"/>
                                        <TextBlock  FontSize="10" VerticalAlignment="Center" Foreground="White">
                            <Run Text=" -"/>
                            <Run Text="{Binding FileSize}"/>
                                        </TextBlock>
                                        <StackPanel.ContextMenu>
                                            <ContextMenu>
                                                <MenuItem Header="添加(_D)"  Command="{Binding AddChildren}" CommandParameter="{Binding .}" />
                                                <Separator/>
                                                <MenuItem Header="删除(_D)" Command="{Binding DeleteCommand}" CommandParameter="{Binding .}"/>
                                                <MenuItem Header="重命名(_M)" Command="{x:Static XSolution:Commands.ReName}" CommandParameter="{Binding .}"/>
                                                <MenuItem Header="复制(_Y)" Command="{x:Static ApplicationCommands.Copy}" CommandParameter="{Binding .}" />
                                                <Separator/>
                                                <Separator/>
                                                <MenuItem Header="打开所在的文件夹(_O)" Command="{Binding OpenExplorerCommand}" CommandParameter="{Binding .}"/>
                                                <MenuItem Header="属性(_R)"  Command="{Binding AttributesCommand}" CommandParameter="{Binding .}" />
                                            </ContextMenu>
                                        </StackPanel.ContextMenu>
                                    </StackPanel>
                                </HierarchicalDataTemplate>

                                <HierarchicalDataTemplate DataType="{x:Type XSolution:GrifFile}" ItemsSource="{Binding VisualChildren}" >
                                    <StackPanel Background="Transparent" Style="{StaticResource style_treeViewItem_panel}"  >
                                        <Image  Style="{StaticResource style_treeViewItem_icon}" Source="/Solution;component/images/grif.png" />
                                        <local:EditableTextBlock   Style="{StaticResource EditableTextBlockStyle}" IsEditMode="{Binding IsEditMode}" Content="{Binding .}"/>
                                        <TextBlock  FontSize="10" VerticalAlignment="Center" Foreground="White">
                                <Run Text=" -"/>
                                <Run Text="{Binding FileSize}"/>
                                        </TextBlock>
                                        <StackPanel.ContextMenu>
                                            <ContextMenu>
                                                <MenuItem Header="添加(_D)"  Command="{Binding AddChildren}" CommandParameter="{Binding .}" />
                                                <Separator/>
                                                <MenuItem Header="删除(_D)" Command="{Binding DeleteCommand}" CommandParameter="{Binding .}"/>
                                                <MenuItem Header="重命名(_M)" Command="{x:Static XSolution:Commands.ReName}" CommandParameter="{Binding .}"/>
                                                <MenuItem Header="复制(_Y)" Command="{x:Static ApplicationCommands.Copy}" CommandParameter="{Binding .}" />
                                                <Separator/>
                                                <MenuItem Header="导出(_E)">
                                                    <MenuItem Header="导出为" Command="{Binding GrifExportAsCommand}" CommandParameter="{Binding .}" />
                                                    <Separator/>
                                                    <MenuItem Header="导出BMP..."  Command="{Binding ExportAsBMPCommand}" CommandParameter="{Binding .}"   />
                                                    <MenuItem Header="导出Tiff..."  Command="{Binding ExportAsTiffCommand}" CommandParameter="{Binding .}"   />
                                                    <MenuItem Header="导出JPEG..."  Command="{Binding ExportAsJPEGCommand}" CommandParameter="{Binding .}"   />
                                                    <MenuItem Header="导出PNG..."  Command="{Binding ExportAsPNGCommand}" CommandParameter="{Binding .}"   />
                                                </MenuItem>
                                                <Separator/>
                                                <MenuItem Header="打开所在的文件夹(_O)" Command="{Binding OpenExplorerCommand}" CommandParameter="{Binding .}"/>
                                                <MenuItem Header="属性(_R)"  Command="{Binding AttributesCommand}" CommandParameter="{Binding .}" />
                                            </ContextMenu>
                                        </StackPanel.ContextMenu>
                                    </StackPanel>
                                </HierarchicalDataTemplate>

                                <HierarchicalDataTemplate DataType="{x:Type XSolution:DerivativeSeriesFile}"  ItemsSource="{Binding VisualChildren}" >
                                    <StackPanel Background="Transparent" Style="{StaticResource style_treeViewItem_panel}"  >
                                        <Image  Style="{StaticResource style_treeViewItem_icon}" Source="/Solution;component/images/图片3.png" />
                                        <local:EditableTextBlock   Style="{StaticResource EditableTextBlockStyle}" IsEditMode="{Binding IsEditMode}" Content="{Binding .}"/>
                                        <TextBlock  FontSize="10" VerticalAlignment="Center" Foreground="White">
                            <Run Text=" -"/>
                            <Run Text="{Binding FileSize}"/>
                                        </TextBlock>

                                        <StackPanel.ContextMenu>
                                            <ContextMenu>
                                                <!--<MenuItem Header="剪切(_T)" Command="{x:Static ApplicationCommands.Cut}" CommandParameter="{Binding .}" />-->
                                                <MenuItem Header="删除(_D)" Command="{Binding DeleteCommand}" CommandParameter="{Binding .}"/>
                                                <MenuItem Header="重命名(_M)" Command="{x:Static XSolution:Commands.ReName}" CommandParameter="{Binding .}"/>
                                                <MenuItem Header="复制(_Y)" Command="{x:Static ApplicationCommands.Copy}" CommandParameter="{Binding .}" />
                                                <Separator/>
                                                <MenuItem Header="导出(_E)">
                                                    <MenuItem Header="快速导出为"  />
                                                    <MenuItem Header="导出为" />
                                                    <Separator/>
                                                </MenuItem>
                                                <Separator/>
                                                <MenuItem Header="打开所在的文件夹(_O)" Command="{Binding OpenExplorer}" CommandParameter="{Binding .}"/>
                                                <MenuItem Header="属性(_R)"  CommandParameter="{Binding .}" />
                                            </ContextMenu>
                                        </StackPanel.ContextMenu>
                                    </StackPanel>
                                </HierarchicalDataTemplate>
                                <HierarchicalDataTemplate DataType="{x:Type XSolution:DerivativeFile}"  ItemsSource="{Binding VisualChildren}" >
                                    <StackPanel Background="Transparent" Style="{StaticResource style_treeViewItem_panel}"  >
                                        <Image  Style="{StaticResource style_treeViewItem_icon}" Source="/Solution;component/images/图片3.png" />
                                        <local:EditableTextBlock   Style="{StaticResource EditableTextBlockStyle}" IsEditMode="{Binding IsEditMode}" Content="{Binding .}"/>
                                        <TextBlock  FontSize="10" VerticalAlignment="Center" Foreground="White">
                            <Run Text=" -"/>
                            <Run Text="{Binding FileSize}"/>
                                        </TextBlock>

                                        <StackPanel.ContextMenu>
                                            <ContextMenu>
                                                <!--<MenuItem Header="剪切(_T)" Command="{x:Static ApplicationCommands.Cut}" CommandParameter="{Binding .}" />-->
                                                <MenuItem Header="删除(_D)" Command="{Binding DeleteCommand}" CommandParameter="{Binding .}"/>
                                                <MenuItem Header="重命名(_M)" Command="{x:Static XSolution:Commands.ReName}" CommandParameter="{Binding .}"/>
                                                <MenuItem Header="复制(_Y)" Command="{x:Static ApplicationCommands.Copy}" CommandParameter="{Binding .}" />
                                                <Separator/>
                                                <MenuItem Header="导出(_E)">
                                                    <MenuItem Header="快速导出为"  />
                                                    <MenuItem Header="导出为" />
                                                    <Separator/>
                                                </MenuItem>
                                                <Separator/>
                                                <MenuItem Header="打开所在的文件夹(_O)" Command="{Binding OpenExplorer}" CommandParameter="{Binding .}"/>
                                                <MenuItem Header="属性(_R)"  CommandParameter="{Binding .}" />
                                            </ContextMenu>
                                        </StackPanel.ContextMenu>
                                    </StackPanel>
                                </HierarchicalDataTemplate>
                            </TreeView.Resources>


                        </TreeView>
                    </UniformGrid>

                </Grid>



            </Border>
        </DockPanel>

    </Grid>
</base:BaseWindow>
