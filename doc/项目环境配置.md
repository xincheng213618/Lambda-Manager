# C++ 项目环境配置 - 2022.10.17

## 1.初学阶段

在最开始的时候的学习往往通过百度，查询C++应该如何配置环境，程序才能正确运行。

得到的答案，无非就是通过绝对路径引用的方式，配置好的环境库的包含目录和库目录。

因为简单，而且容易理解，也很少会有人愿意去继续优化这种方式。

带来的缺陷也很简单，C++程序繁琐的移植性。拷贝一个C++的项目，对其中的库配置起来极其繁琐。

这个阶段复制工程可能更喜欢直接复制文件。

## 2.提高程序的可移植性

为了解决C++程序的移植问题，因为许多的项目，并非是个人项目，需要协作，通过Git的形式共享的项目，不可能说路径不统一。

有几种方式，因为D盘并非所有人都有，但是C盘都存在，所以项目的库文件等信息，统统配置在一个统一的根目录下，进行管理和维护。

这种情况下的缺陷在，多项目，多工程时，库引用和版本的配置，会让这套结构变得非常难以管理。

也有的，把库目录配置在工程内部，通过相对路径去链接库，在移植的时候直接把工程打包，丢在另一个人的电脑上，就可以直接运行了。

这种情况对于移植而言时非常轻松的，因为不需要考虑版本的问题，但是代价就是工程直接膨胀了，有一些库很大，比如OpenCV，Cuda之类的，配置在项目中，或者多个项目时，非常占用电脑空间。

这个阶段复制工程，会考虑到复制git这种，或者是直接给工程地址，让对方自己clone。

## 3.Props简化项目的调用 (msvc)

因为对于C++ 的编译器而言，配置多lib，并不会造成体积的增加，程序还是只链接用到的部分，所以在项目中，需要重复进行调用的部分，比如在同一个工程下的多个项目，可以通过同一套相同结构的信息进行配置，Visual Studio 就提供了这么一套支持，可以通过将相同的信息写入props 中，其他的引用相同库的项目，也可以连接到同一个props中。

这样，一个库就可以简化为我们只需要写一次配置文件。

## 4.环境变量

对于2，绝对路径带来了复杂度的提高，而相对路径则是工程内部结构不能轻易调整，和程序容易膨胀。

兼得的方法就是通过环境变量来配置项目内部的关联性。

比如配置OpenCV的库，可以在系统的环境变量中，添加相对应的键，然后props的配置，依赖于系统环境变量中的这个位置。

这个项目库就可以和项目完成分离，并且位置不在受到限制，可以放在任意位置。

同时工程本身也可以不保存这些库的副本，让Git的体积更小一些。

当然并非是每一个库都应该这样配置，有些库版本太多，下载很困难，又或者体积并不大的时候，在工程中多保存一份副本，可以节约很多的精力。

## 5.Make,Cmake ，ninja 等

如果该工程是一些基础库，又或者作为源代码发布，用户可能并不使用Visual Studio ，甚至是不使用MSVC，而是GCC,clang的话，props显然并不是一个很好的方案。用户的环境变量，Windows 的管理和Linux ,Mac,也显然不一样。

那样用户拿到源码之后，应该如何快速能够编译这个项目呢？

写Make ,或者 Cmake 这种生成工程的文件，能够根据不同的平台，生成对映的能够编译的工程，或者是直接编译。

## PS：

对于开发基础库，这种级别的项目的话，CMake 显然是很好的方案。

如果是通常的项目工程，在Window上，显然通过环境变量+Props这种方案是一种相对来说，最优雅的解决方案。

但是对于VS 来说，它默认的添加方式是相对路径的，也就是说如果想要达到一种相对较好的效果，也需要稍微的动手修改vcxproj的内容。



